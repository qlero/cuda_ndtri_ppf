# Constants found in:
# https://github.com/scipy/scipy/blob/main/scipy/special/cephes/ndtri.c

import torch

SQUARE_ROOT_PI: torch.tensor = torch.tensor(2.50662827463100050242e0)

# approximation for 0 <= |y - 0.5| <= 3/8

APPROX_INTERVAL_Y_MIN_HALF_1: torch.Tensor = torch.Tensor([
    -5.99633501014107895267e1,
    9.80010754185999661536e1,
    -5.66762857469070293439e1,
    1.39312609387279679503e1,
    -1.23916583867381258016e0
])

APPROX_INTERVAL_Y_MIN_HALF_2: torch.Tensor = torch.Tensor([
    1.00000000000000000000e0, # difference with scipy implementation
    1.95448858338141759834e0,
    4.67627912898881538453e0,
    8.63602421390890590575e1,
    -2.25462687854119370527e2,
    2.00260212380060660359e2,
    -8.20372256168333339912e1,
    1.59056225126211695515e1,
    -1.18331621121330003142e0
])

# Approximation for interval z = sqrt(-2 log y ) between 2 and 8
# i.e., y between exp(-2) = .135 and exp(-32) = 1.27e-14.

APPROX_INTERVAL_SQRT_2LOGY2to8_1: torch.Tensor = torch.Tensor([
    4.05544892305962419923e0,
    3.15251094599893866154e1,
    5.71628192246421288162e1,
    4.40805073893200834700e1,
    1.46849561928858024014e1,
    2.18663306850790267539e0,
    -1.40256079171354495875e-1,
    -3.50424626827848203418e-2,
    -8.57456785154685413611e-4
])

APPROX_INTERVAL_SQRT_2LOGY2to8_2: torch.Tensor = torch.Tensor([
    1.00000000000000000000e0, # difference with scipy implementation
    1.57799883256466749731e1,
    4.53907635128879210584e1,
    4.13172038254672030440e1,
    1.50425385692907503408e1,
    2.50464946208309415979e0,
    -1.42182922854787788574e-1,
    -3.80806407691578277194e-2,
    -9.33259480895457427372e-4
])

# Approximation for interval z = sqrt(-2 log y ) between 8 and 64
#  i.e., y between exp(-32) = 1.27e-14 and exp(-2048) = 3.67e-890.

APPROX_INTERVAL_SQRT_2LOGY8to64_1: torch.Tensor = torch.Tensor([
    3.23774891776946035970e0,
    6.91522889068984211695e0,
    3.93881025292474443415e0,
    1.33303460815807542389e0,
    2.01485389549179081538e-1,
    1.23716634817820021358e-2,
    3.01581553508235416007e-4,
    2.65806974686737550832e-6,
    6.23974539184983293730e-9
])

APPROX_INTERVAL_SQRT_2LOGY8to64_2: torch.Tensor = torch.Tensor([
    1.00000000000000000000e0,
    6.02427039364742014255e0,
    3.67983563856160859403e0,
    1.37702099489081330271e0,
    2.16236993594496635890e-1,
    1.34204006088543189037e-2,
    3.28014464682127739104e-4,
    2.89247864745380683936e-6,
    6.79019408009981274425e-9
])

CHECK_EXPMIN2: torch.tensor = torch.tensor(
    0.13533528323661269189
)

CHECK_1_MINUS_EXPMIN2: torch.tensor = torch.tensor(
    1.0 - 0.13533528323661269189
)